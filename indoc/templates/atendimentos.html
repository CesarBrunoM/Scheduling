{% extends 'base.html' %}

{% block title %}
Novo atendimento
{% endblock %}

{% block page %}
  <h4>Atendimentos</h4>
{% endblock %}

{% block button %}                                
    <a href="{{ url_for('cadastro_atendimento') }}">
        <button type="button" class="btn btn-primary profile-button">Novo</button>
    </a>
    <a href="{{ url_for('usuario') }}">
        <button type="button" class="btn btn-primary profile-button">Filtros</button>
    </a>
{% endblock %}

{% block body %}

<div class="conteiner mt-2 p-5">
    <h1>Atendimentos</h1>
    <hr>
    {% for atendimento in atendimentos %}
    <a class="link-dark" href="{{ url_for('visualizar_atendimento', atendimento_id=atendimento.id) }}"
                             style="text-decoration:none">
        <div class="row mt-4 p-2 bgcard">
            <div class="col col-2">
                <div class="card-body text-center">
                    <img src="{{ url_for('static', filename='logomarca_cliente/{}'.format(atendimento.cliente.logomarca)) }}"
                         alt="avatar"
                         class="rounded-circle img-fluid" style="width: 100px;">
                </div>
            </div>
            <div class="col col-10">
                <h4>Protocolo: #{{ atendimento.protocolo }} - {{ atendimento.cliente.nome }}</h4>
                {% if atendimento.status == "Aberto" %}
                    <b class="badge badge-pill bg-primary">{{ atendimento.status }}</b>
                {% elif atendimento.status == "Atendendo" %}
                    <b class="badge badge-pill bg-warning">{{ atendimento.status }}</b>
                {% elif atendimento.status == "Fechado" %}
                    <b class="badge badge-pill bg-success">{{ atendimento.status }}</b>
                {% elif atendimento.status == 'Cancelado' %}
                    <b class="badge badge-pill bg-danger">{{ atendimento.status }}</b>
                {% endif %}
                {% if atendimento.prioridade == "Baixo" %}
                <b class="badge badge-pill bg-primary">{{ atendimento.prioridade }}</b>
                {% elif atendimento.prioridade == "Normal" %}
                    <b class="badge badge-pill bg-info">{{ atendimento.prioridade }}</b>
                {% elif atendimento.prioridade == "Alta" %}
                    <b class="badge badge-pill bg-warning">{{ atendimento.prioridade }}</b>
                {% elif atendimento.prioridade == 'Urgente' %}
                    <b class="badge badge-pill bg-danger">{{ atendimento.prioridade }}</b>
                {% endif %}     
                <hr>
                <h6><b>Problema:</b> {{ atendimento.problema.descricao }} - <b>Data Abertura:</b> {{
                    datetime.strftime(atendimento.data_cadastro, '%d/%m/%Y às %H:%M') }}</h6>
                <b>Observação</b>
                <p>{{ atendimento.observacao }}</p>
            </div>
        </div>
    </a>
    {% endfor %}
</div>

{% endblock %}